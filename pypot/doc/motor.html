<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>The Motor object &mdash; Poppy project 1.1.0 documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="../../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="../../_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="../../_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="../../_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     '1.1.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="../../_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../../_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="shortcut icon" href="../../_static/poppy_flower_logo-small.png"/>
    <link rel="top" title="Poppy project 1.1.0 documentation" href="../../index.html" />
    <link rel="up" title="Introduction" href="index.html" />
    <link rel="next" title="Primitives" href="primitive.html" />
    <link rel="prev" title="The Robot object and the controllers" href="robot.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html">Poppy project 1.1.0 documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">The Motor object</a><ul>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#registers">Registers</a></li>
<li><a class="reference internal" href="#torque-and-compliance">Torque and compliance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controlling-motors">Controlling motors</a><ul>
<li><a class="reference internal" href="#controlling-in-position">Controlling in position</a></li>
<li><a class="reference internal" href="#controlling-in-speed">Controlling in speed</a></li>
<li><a class="reference internal" href="#the-pypot-dynamixel-motor-dxlmotor-goto-position-function">The pypot.dynamixel.motor.DxlMotor.goto_position function</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="robot.html" title="The Robot object and the controllers" accesskey="P">previous </a></li>
              <li><a href="primitive.html" title="Primitives" accesskey="N">next </a></li>
              <li><a href="../../py-modindex.html" title="Python Module Index" >modules </a></li>
              <li><a href="../../genindex.html" title="General Index" accesskey="I">index </a></li>
              <li><a href="../../development_guides/index.html" >Development Guides</a></li>
              <li><a href="index.html" accesskey="U">Introduction</a></li>
            
            <li class="visible-xs"><a href="../../_sources/pypot/doc/motor.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="../../search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
    <p class="logo"><a href="../../index.html">
      <img class="logo" src="../../_static/poppy_name.pdf" alt="Logo"/>
    </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Motor object</a><ul>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#registers">Registers</a></li>
<li><a class="reference internal" href="#torque-and-compliance">Torque and compliance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controlling-motors">Controlling motors</a><ul>
<li><a class="reference internal" href="#controlling-in-position">Controlling in position</a></li>
<li><a class="reference internal" href="#controlling-in-speed">Controlling in speed</a></li>
<li><a class="reference internal" href="#the-pypot-dynamixel-motor-dxlmotor-goto-position-function">The pypot.dynamixel.motor.DxlMotor.goto_position function</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="robot.html"
                        title="previous chapter">The Robot object and the controllers</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="primitive.html"
                        title="next chapter">Primitives</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/pypot/doc/motor.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="../../search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="the-motor-object">
<span id="the-motor-object"></span><h1>The Motor object<a class="headerlink" href="#the-motor-object" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<span id="overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The  <a class="reference external" href="pypot.robot.html#pypot.robot.robot.Robot">pypot.robot.robot.Robot</a> class contains a list of
<a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor</a>, each <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor</a>
being linked to a physical Dynamixel motor.</p>
<div class="section" id="registers">
<span id="registers"></span><h3>Registers<a class="headerlink" href="#registers" title="Permalink to this headline">¶</a></h3>
<p>This class provides access to (see <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.registers</a> for an exhaustive list):</p>
<ul class="simple">
<li>id: motor id</li>
<li>motor name</li>
<li>motor model</li>
<li>present position/speed/load</li>
<li>goal position/speed/load</li>
<li>compliant</li>
<li>motor orientation and offset</li>
<li>angle limit</li>
<li>temperature</li>
<li>voltage</li>
</ul>
<p>Temperature and load can give you an idea of how much effort a motor
produces:</p>
<pre class="literal-block">
for m in robot.motors:
    print &quot;motor &quot;,m.name, &quot;(&quot;,m.model,&quot;), id: &quot;,m.id
    print 'temperature: ',m.temperature
    print &quot;load: &quot;, m.load
</pre>
</div>
<div class="section" id="torque-and-compliance">
<span id="torque-and-compliance"></span><h3>Torque and compliance<a class="headerlink" href="#torque-and-compliance" title="Permalink to this headline">¶</a></h3>
<p>A motor with compliance will not exert any torque. You can move it by
hand. Removing compliance will cause the motor to exert torque and
therefore move to get to its goal position. The compliance can be set
for each motor individually:</p>
<pre class="literal-block">
robot.head_z.compliant = False
</pre>
<p>or can be set at <a class="reference external" href="robot.html">robot level</a>.</p>
<p>You can set the compliance mode to &#8216;safe&#8217; (as opposed to &#8216;dummy&#8217;) to
have the robot set compliance at angle limits, preventing you to move it
outside of the authorized range. It also prevents the brutal moves when
putting back compliance and the robot wants to go back inside its angle
limits.</p>
<pre class="literal-block">
print robot.head_z.angle_limit
robot.head_z.compliant_behavior('safe')
robot.head_z.compliant = True
#now try moving the head with your hands beyond the angle limits
</pre>
<p>You can also change the maximal torque that the robot can use. Use a
value between 0 (no torque) and 100 (max torque). The resulting maximal
torque depends onthe model of the robot:</p>
<pre class="literal-block">
robot.head_z.max_torque = 20
</pre>
<p>Reducing the maximal torque makes your robot less powerful and therefore
less harmfull and adds elasticity to the joints: if you apply a force on
it,it moves because it does not have enough torque to resist, but it
goes back to its goal position when you stop applying the force.</p>
</div>
</div>
<div class="section" id="controlling-motors">
<span id="controlling-motors"></span><h2>Controlling motors<a class="headerlink" href="#controlling-motors" title="Permalink to this headline">¶</a></h2>
<div class="section" id="controlling-in-position">
<span id="controlling-in-position"></span><h3>Controlling in position<a class="headerlink" href="#controlling-in-position" title="Permalink to this headline">¶</a></h3>
<p>Dynamixel servomotors will use their internal controller to reach and
stay at the angle defined in the goal_position register (in degree). If
this angle isn&#8217;t between the minimum and maximum angle (see <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.angle_limit</a>), the goal angle will
automatically be taken back into the limits:</p>
<pre class="literal-block">
for m in robot.motors:
    m.compliant = False
    m.goal_position = 0

time.sleep(2)

for m in robot.motors:
    print &quot;position: &quot;, m.present_position, &quot;(limits: &quot;,m.angle_limit, &quot;)&quot;
</pre>
</div>
<div class="section" id="controlling-in-speed">
<span id="controlling-in-speed"></span><h3>Controlling in speed<a class="headerlink" href="#controlling-in-speed" title="Permalink to this headline">¶</a></h3>
<p>You can also control your robot in speed. Set the
<a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goal_speed</a> attribute to the desired
value in degree per seconds. This automatically sets the
<a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goal_position</a> to the maximal or
minimal value (depending on the sign of the speed).</p>
<p>The motor will remain at the given speed until it gets a new order or it
reaches its angle limit.</p>
<p>Example of robot making &#8216;yes&#8217; with its head:</p>
<pre class="literal-block">
goal = 20

t_init = time.time()

while time.time() - t_init &lt; 20:

    if abs(robot.head_y.present_position) &gt; abs(goal):
        goal = -goal

    speed = 0.1*(goal - robot.head_y.present_position)
    robot.head_y.goal_speed = speed

    time.sleep(0.1)
</pre>
<blockquote>
<div><p><strong>note</strong></p>
<p>You could also use the wheel mode settings where you can directly
change the <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.moving_speed</a>.
Nevertheless, while the motor will turn infinitely with the wheel
mode, here with the <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goal_speed</a> the
motor will still respect the angle limits.</p>
</div></blockquote>
<blockquote>
<div><p><strong>warning</strong></p>
<p>If you set both <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goal_speed</a> and
<a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goal_position</a> only the last command
will be executed. Unless you know what you are doing, you should avoid
to mix these both approaches.</p>
</div></blockquote>
</div>
<div class="section" id="the-pypot-dynamixel-motor-dxlmotor-goto-position-function">
<span id="the-pypot-dynamixel-motor-dxlmotor-goto-position-function"></span><h3>The <a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goto_position</a> function<a class="headerlink" href="#the-pypot-dynamixel-motor-dxlmotor-goto-position-function" title="Permalink to this headline">¶</a></h3>
<p>If you want a servo to go to a certain position in a certain time (for
synchronization reasons...), use the
<a class="reference external" href="pypot.dynamixel.html#pypot.dynamixel.motor.DxlMotor">pypot.dynamixel.motor.DxlMotor.goto_position</a>  function. It take two mandatory
arguments: position to reach (in degrees) and the duration:</p>
<pre class="literal-block">
robot.head_z.goto_position(20, 3)
</pre>
<p>To synchronize several motors, have a look at the
<a class="reference external" href="pypot.robot.html#pypot.robot.robot.Robot">pypot.robot.robot.Robot.goto_position</a> at robot level.</p>
<p>By default, this function return immediatelly and is cancelled if
another one is run later, even if the 3 seconds are not over.</p>
<p>You can set the optionnal <em>wait</em> parameter to True to make this function
blocking, therefore the next line in the script will execute only when
the 3 seconds are over.</p>
<p>The other optionnal parameter is <em>control</em>. You can specify &#8216;dummy&#8217; or
&#8216;minijerk&#8217; (default) to define which algorithm is used in used in
background to bring the motor to the desired position.</p>
<p>&#8216;dummy&#8217; is a simple controller, where you divide the angle to travel by
the time and you set the goal speed to this value. As the motor can&#8217;t go
from thois speed to 0 at arrival in no time, a slight overshoot can
happen. The &#8216;minijerk&#8217; controller has a more complex algorithm to slow
down before and arrive on time without overshoot.</p>
<pre class="literal-block">
robot.head_z.goto_position(20, 3, control='dummy', wait=True)
</pre>
<p>TODO: sensors doc, but work in progress</p>
</div>
</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="../../index.html">Poppy project 1.1.0 documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="robot.html" title="The Robot object and the controllers" >previous</a></li>
        <li><a href="primitive.html" title="Primitives" >next</a></li>
        <li><a href="../../py-modindex.html" title="Python Module Index" >modules</a></li>
        <li><a href="../../genindex.html" title="General Index" >index</a></li>
        <li><a href="../../development_guides/index.html" >Development Guides</a></li>
        <li><a href="index.html" >Introduction</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2015, INRIA.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>